# 3Week_정회성.md

## Title: [3Week] 정회성

### 미션 요구사항 분석 & 체크리스트

---
### 필수미션
- [x] 네이버 클라우드 플랫폼을 통한 배포(도메인 없이, IP로 접속)q
  - [x] 강사님 가이드 영상 따라 진행하기
    - [x] ```https://서버IP:포트/``` 형태로 접속이 가능
      - [x] ```https://www.codelike.org/``` 형태로 접속 가능
    - [x] 운영서버에서는 각종 소셜로그인, 인스타 아이디 연결이 안되어도 됩니다.
      - [x] 접속되도록 uri 추가하기
- [ ] 호감표시/호감사유변경 후, 개별 호감표시건에 대해서, 3시간 동안은 호감취소와 호감사유변경을 할 수 없도록 작업
  - [x] 호감표시를 한 후 개별호감표시건에 대해서, 3시간 동안은 호감취소와 호감사유변경을 할 수 없도록 작업
    - [x] 호감 표시를 한 시간으로부터 3시간이 지난 시간을 저장하기
    - [x] 취소 가능 시간에서 현재 시간 빼서 화면에 출력하기
      - [x] "O시간 O분 O초" 의 형태로 출력되도록 하기
    - [x] 시간이 지나기 전에는 호감취소 및 호감사유변경 버튼을 누르지 못하게 하기 
  - [x] 호감사유변경을 한 후 개별호감표시건에 대해서, 3시간 동안은 호감취소와 호감사유변경을 할 수 없도록 작업
    - [x] 호감사유변경을 한 시간으로부터 3시간이 지난 시간을 저장하기
    - [x] 위의 내용과 동일하게 진행
### 선택미션
- [x] 알림기능 구현
  - [x] notification 테이블에 데이터 저장하기
  - [x] 호감표시를 받은 경우 알림페이지에 나타나도록 구현
  - [x] 호감사유가 변경된 경우 알림페이지에 나타나도록 구현
  - [x] 각각의 알림은 생성시 ```readDate```가 ```null```이어야 한다.
  - [x] 사용자가 알림을 읽으면 ```readDate```가 ```현재날짜```로 세팅되어야 한다.
  - [x] 호감취소를 할 경우 대상 알림페이지에 나타나도록 구현
  - [x] 성별을 변경할 경우 대상 알림페이지에 나타나도록 구현

### N주차 미션 요약

---

**[접근 방법]**
- 필수미션 1
  - 네이버 클라우드를 이용한 배포의 경우 강사님의 설명 영상을 그대로 따라가며 미션을 진행하였다.
  - 중간에 자꾸 안돼서 이유를 찾아보니 강사님의 ```codelike.app``` 도메인을 그대로 가져와 사용하였다.
  - 항상 생각하면서 설명 영상을 따라가자.
- 필수미션 2
  - 쿨타임이 아직 지나지 않았을 때 호감 사유 변경과 호감 취소 버튼 자체가 비활성화 되므로 기능적으로 구현할 곳은 없다고 생각하였다.
  - 따라서 쿨타임까지 얼마나 시간이 남았는지만 계산을 하였다.
  - 호감을 등록한 시간에서 쿨타임만큼 지난 시간을 저장하고, 그 시간과 현재 시간의 차이를 구해주었다.
  - 단순히 몇시간 몇분 몇초 전 이라고 나오는 것보다는 실제 어플리케이션처럼 ```방금 전 / 몇 분 전 / 몇 시간 전``` 이런 식으로 등록되면 좋을 것 같다고 생각하여 경우를 나눠서 return 해주었다.
  - 아직 구현하지 못했지만 ```며칠 전 / 몇 달 전 / 몇 년 전```도 구현해보려고 한다.
- 선택미션
  - 이미 구현이 되어있는 ```EventListener```를 적극 활용하였다.
  - 호감을 등록한 경우, 호감을 취소한 경우, 호감 사유를 변경한 경우, 호감표시자의 성별을 변경한 경우 모든 경우에 대해 ```EventListner``` 코드가 작성되어 있어서 쉽게 구현할 수 있었다.
  - 다만 ```InstaMember```의 경우와 다르게, 변경 또는 삭제에서 해당 객체를 수정하거나 삭제하는 것이 아닌 ```notification```에 새로운 객체를 계속해서 추가하는 쪽으로 구현을 진행하였다.
  - 위와 같이 구현을 한 이유는 누군가 호감을 삭제했을 때, 그 전에 호감을 등록했던 것에 대한 알림이 사라지는 것은 부자연스럽다고 생각했기 때문이다.
  - 알림창은 내가 별도로 해당 알림을 삭제하지 않는 이상 계속해서 기록되어 있는 것이 자연스럽다고 생각하고 위와 같이 구현하였다.

**[특이사항]**
- 필수미션 1
  - 설명 영상을 보며 해당 기능을 구현은 하였으나 아직 이해도는 떨어지는 것 같다.
  - 여러 번 반복해보며 이해도를 높여야 할 것 같다.
- 필수미션 2
  - 미션을 시작하기 전에 강사님이 이 기능을 구현해보라고 하셨을 때, 쿨타임이 지나지 않으면 취소 또는 사유 변경 버튼을 눌렀을 때 오류메시지가 나오도록 하였다.
  - 강사님의 경우 아예 버튼 자체를 누르지 못하게 비활성화시키셨다.
  - 나는 기능을 구현할 때 너무 백엔드적으로만 생각하는 것 같다.
  - 조금 더 다양한 방법과 원초적인 방법도 생각해 볼 필요가 있는 것 같다.
- 선택미션
  - ```EventListner```가 없었다면 어떤 식으로 구현해야 했을 지 막막했을 것 같다.
  - 알림을 읽으면 ```readDate```를 변경하는 부분에서 영속성 컨텍스트는 변경사항을 자동으로 감지하여 수정하는 것으로 알고 있는데 수정이 되지 않아 애를 먹었다.
    - 이 부분에 대해서는 아직 원인을 찾지 못하였다.
    - 영속성 컨텍스트에 대해 내가 놓친 부분이 있을 것 같아 다시 한 번 천천히 뜯어봐야할 것 같다.
  - 성별 변경의 경우 성별을 변경하는 기능을 아직 구현하지 못해 확인을 하지 못했다.
    - 해당 기능을 추가적으로 구현해봐야 할 것 같다.